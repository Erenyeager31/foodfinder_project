<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>foodstall ownwer fill details</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />
    <script src="https://ajax.aspnetCDN.com/ajax/jQuery/jQuery-3.3.1.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js"
      integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa"
      crossorigin="anonymous"
    ></script>
    <!-- <style></style> -->
  </head>

  <body style="background-image: url('/static/fries.jpg')">
    <nav class="navbar navbar-dark bg-dark fixed-top opacity-75">
      <div class="container-fluid">
        <a class="navbar-brand opacity-100" href="#">Food Finder</a>
        <ul class="nav justify-content-center">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="home">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="aboutus">About Us</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="contactus">Contact Us</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="profile">Profile</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="showmaps">Maps</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="search_filter">Search</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" onclick="showcart()">Cart</a>
          </li>
        </ul>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasDarkNavbar"
          aria-controls="offcanvasDarkNavbar"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div
          class="offcanvas offcanvas-end text-bg-dark"
          tabindex="-1"
          id="offcanvasDarkNavbar"
          aria-labelledby="offcanvasDarkNavbarLabel"
        >
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel">
              FoodFinder
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="offcanvas"
              aria-label="Close"
            ></button>
          </div>
          <div class="offcanvas-body">
            <form class="d-flex mt-3" role="search">
              <input
                class="form-control me-2"
                type="search"
                placeholder="Search"
                aria-label="Search"
              />
              <button class="btn btn-success" type="submit">Search</button>
            </form>
            <br />
            <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
              <a class="nav-link active" aria-current="page" href="home">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="profile">Profile</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="fill_details_seller">Fill and Edit Details</a>
            </li>

            {% for i in data%} {% if i.role == 'Homemaker' %}
              <!--*** Stall Owner needs to be changed to Homemaker-->
              <li class="nav-item">
                <a class="nav-link" href="uploadrecipe">Upload Recipe</a>
              </li>
              {% endif %} {% endfor %}

            <li class="nav-item">
              <a class="nav-link" href="uploadfood">Add Food</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="checkorder">Check Orders</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Tansaction History</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="aboutus">About Us</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="contactus">Contact Us</a>
            </li>
            </ul>
            <br />
            <button class="btn btn-light rounded-pill px-3" type="button">
              Logout
            </button>
            <!-- <button type="button" class="btn btn-dark border border-primary ">Logout</button> -->
          </div>
        </div>
      </div>
    </nav>

    <div class="container my-6">
      <br /><br /><br />
      <h2 class="d-flex justify-content-center text-black">Update the Details</h2>
      <div class="container my-4">
        <form id="details_form" class="row g-3">
          {% csrf_token %}
          <!-- {{ data }} -->
          {% for i in data %}
          <div class="col-md-6">
            <label for="name" class="form-label text-black">Name</label>
            <input
              type="text"
              class="form-control opacity-75"
              id="name"
              placeholder="Name"
              value="{{ i.name }}"
              readOnly
            />
          </div>
          <div class="col-md-6">
            <label for="email" class="form-label text-black">Email</label>
            <input
              type="email"
              class="form-control opacity-75"
              id="email"
              placeholder="@gmail.com"
              readOnly
              value="{{ i.email }}"
            />
          </div>
          <div class="col-10">
            <label for="address" class="form-label text-black">Address</label>
            <input
              type="text"
              class="form-control opacity-75"
              id="address"
              placeholder="Enter Address"
              value="{{ i.shop_add }}"
            />
          </div>
          <div class="col-10">
            <label for="business_name" class="form-label text-black">Business Name</label>
            <input
              type="text"
              class="form-control opacity-75"
              id="business_name"
              placeholder="Enter Business Name"
              value="{{ i.business_name }}"
            />
          </div>

          <div class="col-md-6">
            <label for="city" class="form-label text-black">City</label>
            <input
              type="text"
              class="form-control opacity-75"
              id="city"
              placeholder="Enter City"
              value="{{ i.city }}"
            />
          </div>
          <div class="col-md-4">
            <label for="state" class="form-label text-black">State</label>
            <input
              type="text"
              class="form-control opacity-75"
              id="state"
              placeholder="Enter State"
              value="{{ i.state }}"
            />
          </div>
          <div class="col-md-2">
            <label for="zip" class="form-label text-black">Zip</label>
            <input
              type="text"
              class="form-control opacity-75"
              id="zip"
              placeholder="Enter Zip"
              value="{{ i.zip }}"
            />
          </div>

          <div class="col-md-6">
            <label for="phone" class="form-label text-black">Phone no</label>
            <input
              type="texts"
              class="form-control opacity-75"
              id="phone"
              placeholder="Phone no"
              value="{{ i.mobile_no }}"
              readOnly
            />
          </div>

          <div class="col-md-6">
            <label for="accno" class="form-label text-black"
              >Bank Account No</label
            >
            <input
              type="text"
              class="form-control opacity-75"
              id="accno"
              placeholder="enter Account No"
              value="{{ i.bank_act_no }}"
            />
          </div>

          <div class="col-md-6">
            <label for="ifsc" class="form-label text-black">IFSC code</label>
            <input
              type="text"
              class="form-control opacity-75"
              id="ifsc"
              placeholder="Enter IFSC code"
              value="{{ i.ifsc }}"
            />
          </div>

          <div class="col-md-6">
            <label for="branchname" class="form-label text-black"
              >Branch name</label
            >
            <input
              type="text"
              class="form-control opacity-75"
              id="bname"
              placeholder="enter Branch Name"
              value="{{ i.branch_name }}"
            />
          </div>
          <div class="col-12 d-flex justify-content-around">
            <button class="btn btn-primary rounded-pill px-3" type="submit">
              SAVE
            </button>
            <button class="btn btn-primary rounded-pill px-3" type="button" onclick="fetchlocation()">
              Fetch location
            </button>
          </div>
          {% endfor %}
        </form>
      </div>
    </div>

    <!-- footer -->
    <div class="container">
      <footer class="py-3">
        <ul class="nav justify-content-center border-bottom pb-3 mb-3">
          <li class="nav-item">
            <a href="#" class="nav-link px-2 text-body-secondary">Home</a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link px-2 text-body-secondary">Features</a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link px-2 text-body-secondary">Pricing</a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link px-2 text-body-secondary">FAQs</a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link px-2 text-body-secondary">About</a>
          </li>
        </ul>
        <div class="social-icons d-flex justify-content-center">
          <!-- Replace the links below with actual URLs to your social media profiles -->
          <a href="#"><img src="facebook.svg" alt="Facebook" /></a>
          <a href="#"><img src="twitter.svg" alt="Twitter" /></a>
          <a href="#"><img src="linkedin.svg" alt="LinkedIn" /></a>
          <a href="#"><img src="instagram.svg" alt="Instagram" /></a>
        </div>
        <br />
        <p class="text-center text-body-secondary">
          &copy; 2023 FoodFinder, Inc
        </p>
      </footer>
    </div>
  </body>
  <script>
    document.getElementById("details_form").addEventListener('submit',async function(e){
      // alert("hi")
      e.preventDefault()
      const list = []
      const input_elements = document.getElementById("details_form")
      for(i=0;i<input_elements.length;i++){
        // console.log(input_elements[i])
        list.push(input_elements[i].value)
      }
      // console.log(list)
      $.ajax({
        type:"POST",
        url:"/s_save_details",
        data:{
          "name":list[1],
          "email":list[2],
          "shop_add":list[3],
          "business_name":list[4],
          "city":list[5],
          "state":list[6],
          "zip":list[7],
          "mobile_no":list[8],
          "bank_act_no":list[9],
          "ifsc":list[10],
          "branch_name":list[11],
          csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
        },
        success(data){
          alert(data)
        },
        error(err){

        }
      })

    })

    async function success(position){
      // alert("Inside")
      const coords = await position['coords']
      const latitude = await coords.latitude
      const longitude = await coords.longitude
      // console.log(latitude+" "+longitude)
      location_shop = await latitude+","+longitude
      // alert(location_shop)
      $.ajax({
        type:"GET",
        url:"/save_location",
        data:{
          "username":sessionStorage.getItem("username"),
          "business_name":document.getElementById("business_name").value,
          "location":location_shop
        },
        success(data){
          status_data = JSON.parse(data)
          alert(status_data.message)
        },
        error(e){
          console.log(e)
        }
      })
    }
    function error(error){
      alert("Error occured")
    }
    function fetchlocation(){
      // alert("Fetching your current location...")
      navigator.geolocation.getCurrentPosition(success,error)
    }
  </script>
</html>
